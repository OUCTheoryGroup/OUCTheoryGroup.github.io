import{r as c,c as d,e as M,f,b as l,w as o,_ as $,E as I,o as r,g as x,d as y,p as R,a as i,z as G,h as L,i as z}from"./index-DaA0Xemu.js";import{_ as j,E as u,u as A,a as S,b as T}from"./_plugin-vue_export-helper-Bo_mlQwW.js";import{E as q}from"./el-scrollbar-CGzrGxzc.js";const H={class:"container mx-auto flex flex-col items-center max-h-screen p-4 space-y-4"},J={key:1,class:"space-y-4"},K={key:0,class:"upload-trigger"},O=["src"],Q={class:"el-upload-list__item-actions"},W=["onClick"],X=["onClick"],Z={key:2,class:"flex items-center justify-center w-full"},F={key:0},ee={key:1,class:"text-center text-gray-500"},te=["src"],le={__name:"DailyForecastPredictView",setup(ae){const _=c(null),m=c([]),p=c(!1),n=c([]),w=c(""),g=c(!1),V=e=>new Promise((t,v)=>{const s=new FileReader;s.readAsDataURL(e),s.onload=()=>t(s.result),s.onerror=h=>v(h)}),D=e=>e.type==="image/png"?!0:(u.error("仅支持PNG文件"),!1),E=()=>{u.warning("最多只能上传14张图片")},P=e=>{e.status==="ready"||(e.status==="success"?u.success(`${e.name} 文件上传成功`):e.status==="error"&&u.error(`${e.name} 文件上传失败`))},k=async e=>{!e.url&&!e.preview&&(e.preview=await V(e.raw)),w.value=e.url||e.preview,g.value=!0},C=e=>{n.value=n.value.filter(t=>t.uid!==e.uid)},U=()=>{if(!_.value){u.error("请选择日期");return}if(n.value.length!==14){u.error("请上传14张图片");return}A(_.value).then(e=>{m.value=e,p.value=!0}).catch(e=>{u.error("预测失败，请稍后重试"),console.error(e)})},B=()=>{p.value=!1,m.value=[],_.value=null,n.value=[]};return(e,t)=>{const v=I,s=z,h=S,Y=q,b=T;return r(),d("div",H,[p.value?(r(),M(v,{key:0,class:"self-start",onClick:B},{default:o(()=>t[3]||(t[3]=[x(" 返回 ")])),_:1})):f("",!0),p.value?f("",!0):(r(),d("div",J,[l(h,{"file-list":n.value,"onUpdate:fileList":t[0]||(t[0]=a=>n.value=a),class:"upload-demo",action:"https://seaice.52lxy.one:20443/seaice/png-upload",accept:".png","list-type":"picture-card",multiple:!0,limit:14,"before-upload":D,"on-preview":k,"on-change":P,"on-exceed":E},{default:o(()=>[n.value.length<14?(r(),d("div",K,[l(s,{class:"upload-icon"},{default:o(()=>[l(y(R))]),_:1}),t[4]||(t[4]=i("div",{class:"upload-text"},"Upload",-1))])):f("",!0)]),file:o(({file:a})=>[i("div",null,[i("img",{class:"el-upload-list__item-thumbnail",src:a.url,alt:""},null,8,O),i("span",Q,[i("span",{class:"el-upload-list__item-preview",onClick:N=>k(a)},[l(s,null,{default:o(()=>[l(y(G))]),_:1})],8,W),i("span",{class:"el-upload-list__item-delete",onClick:N=>C(a)},[l(s,null,{default:o(()=>[l(y(L))]),_:1})],8,X)])])]),_:1},8,["file-list"]),l(Y,{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=a=>_.value=a),type:"date",placeholder:"选择日期",format:"YYYY/MM/DD","value-format":"YYYY/MM/DD"},null,8,["modelValue"]),l(v,{type:"primary",onClick:U},{default:o(()=>t[5]||(t[5]=[x("提交")])),_:1})])),p.value?(r(),d("div",Z,[m.value.length?(r(),d("div",F,[l($,{images:m.value},null,8,["images"])])):(r(),d("div",ee,"请上传图片并选择日期以查看预测结果"))])):f("",!0),l(b,{modelValue:g.value,"onUpdate:modelValue":t[2]||(t[2]=a=>g.value=a),title:"预览"},{default:o(()=>[i("img",{"w-full":"",src:w.value,alt:"Preview Image"},null,8,te)]),_:1},8,["modelValue"])])}}},re=j(le,[["__scopeId","data-v-ef11f97c"]]);export{re as default};
