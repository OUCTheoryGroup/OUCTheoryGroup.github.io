import{j as r,d as M,k as $,l as I,m as L,E as R}from"./element-plus-BIImm0n2.js";import{q as G,z as j,x as z}from"./@element-plus-W9iT9tjK.js";import{_ as T}from"./index-Cs1uRfJb.js";import{_ as q,u as A}from"./plugin-vueexport-helper-CSOZ5ki9.js";import{r as c,c as d,Q,V as f,L as l,P as o,o as i,T as x,u as h,a as u}from"./@vue-BNSRWWJn.js";import"./lodash-es-QeLhLsho.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-Bd7NwZzn.js";import"./dayjs-CdCgAjqw.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./vue-router-BYwqdpxB.js";import"./axios-CCb-kr4I.js";const S={class:"container mx-auto flex flex-col items-center max-h-screen p-4 space-y-4"},H={key:1,class:"space-y-4"},J={key:0,class:"upload-trigger"},K=["src"],O={class:"el-upload-list__item-actions"},W=["onClick"],X=["onClick"],Z={key:2,class:"flex items-center justify-center w-full"},F={key:0},ee={key:1,class:"text-center text-gray-500"},te=["src"],le={__name:"DailyForecastPredictView",setup(ae){const m=c(null),_=c([]),p=c(!1),n=c([]),k=c(""),g=c(!1),V=e=>new Promise((t,v)=>{const s=new FileReader;s.readAsDataURL(e),s.onload=()=>t(s.result),s.onerror=y=>v(y)}),D=e=>e.type==="image/png"?!0:(r.error("仅支持PNG文件"),!1),P=()=>{r.warning("最多只能上传14张图片")},C=e=>{e.status==="ready"||(e.status==="success"?r.success(`${e.name} 文件上传成功`):e.status==="error"&&r.error(`${e.name} 文件上传失败`))},w=async e=>{!e.url&&!e.preview&&(e.preview=await V(e.raw)),k.value=e.url||e.preview,g.value=!0},E=e=>{n.value=n.value.filter(t=>t.uid!==e.uid)},U=()=>{if(!m.value){r.error("请选择日期");return}if(n.value.length!==14){r.error("请上传14张图片");return}A(m.value).then(e=>{_.value=e,p.value=!0}).catch(e=>{r.error("预测失败，请稍后重试"),console.error(e)})},B=()=>{p.value=!1,_.value=[],m.value=null,n.value=[]};return(e,t)=>{const v=M,s=R,y=$,Y=I,N=L;return i(),d("div",S,[p.value?(i(),Q(v,{key:0,class:"self-start",onClick:B},{default:o(()=>t[3]||(t[3]=[x(" 返回 ")])),_:1})):f("",!0),p.value?f("",!0):(i(),d("div",H,[l(y,{"file-list":n.value,"onUpdate:fileList":t[0]||(t[0]=a=>n.value=a),class:"upload-demo",action:"https://seaice.52lxy.one:20443/seaice/png-upload",accept:".png","list-type":"picture-card",multiple:!0,limit:14,"before-upload":D,"on-preview":w,"on-change":C,"on-exceed":P},{default:o(()=>[n.value.length<14?(i(),d("div",J,[l(s,{class:"upload-icon"},{default:o(()=>[l(h(G))]),_:1}),t[4]||(t[4]=u("div",{class:"upload-text"},"Upload",-1))])):f("",!0)]),file:o(({file:a})=>[u("div",null,[u("img",{class:"el-upload-list__item-thumbnail",src:a.url,alt:""},null,8,K),u("span",O,[u("span",{class:"el-upload-list__item-preview",onClick:b=>w(a)},[l(s,null,{default:o(()=>[l(h(j))]),_:1})],8,W),u("span",{class:"el-upload-list__item-delete",onClick:b=>E(a)},[l(s,null,{default:o(()=>[l(h(z))]),_:1})],8,X)])])]),_:1},8,["file-list"]),l(Y,{modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=a=>m.value=a),type:"date",placeholder:"选择日期",format:"YYYY/MM/DD","value-format":"YYYY/MM/DD"},null,8,["modelValue"]),l(v,{type:"primary",onClick:U},{default:o(()=>t[5]||(t[5]=[x("提交")])),_:1})])),p.value?(i(),d("div",Z,[_.value.length?(i(),d("div",F,[l(T,{images:_.value},null,8,["images"])])):(i(),d("div",ee,"请上传图片并选择日期以查看预测结果"))])):f("",!0),l(N,{modelValue:g.value,"onUpdate:modelValue":t[2]||(t[2]=a=>g.value=a),title:"预览"},{default:o(()=>[u("img",{"w-full":"",src:k.value,alt:"Preview Image"},null,8,te)]),_:1},8,["modelValue"])])}}},ge=q(le,[["__scopeId","data-v-ef11f97c"]]);export{ge as default};
